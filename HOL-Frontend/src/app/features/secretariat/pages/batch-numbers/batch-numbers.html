<div dir="rtl" class="flex flex-col h-screen font-sans text-sm"
     style="background-color: var(--surface-ground);">

  <!-- ========================================== -->
  <!-- 1. شريط الأدوات العلوي -->
  <!-- ========================================== -->
  <div class="border-b p-2 flex justify-between items-center shadow-sm"
       style="background-color: var(--surface-section); border-color: var(--surface-border);">
    
    <!-- الجانب الأيمن: بحث الموظف والأزرار -->
    <div class="flex items-center gap-2">
      
      <!-- مجموعة حقل الموظف -->
      <div class="flex items-center gap-1 border p-1 rounded-sm"
           style="background-color: var(--surface-card); border-color: var(--surface-border);">
        <label class="font-bold text-xs px-1" style="color: var(--text-color);">الموظف</label>
        
        <!-- حقل اسم الموظف -->
        <input type="text" 
               [(ngModel)]="selectedEmployeeName" 
               class="input input-xs input-ghost h-6 w-64 focus:bg-transparent"
               style="background-color: transparent; color: var(--text-color);"
               readonly /> <!-- readonly لأن الاختيار يتم من المودال -->

        <!-- زر الـ ... (يفتح المودال) -->
        <button class="btn btn-xs btn-square btn-ghost border rounded-sm"
                style="background-color: var(--surface-hover); border-color: var(--surface-border); color: var(--text-color);"
                (click)="openEmployeeModal()">
          ...
        </button>
      </div>

      <!-- زر بحث -->
      <button class="btn btn-sm px-4 rounded-sm font-normal h-8 min-h-0"
              style="background-color: var(--surface-hover); color: var(--text-color); border-color: var(--surface-border);"
              (click)="search()">
        بحث
      </button>

      <!-- زر توجيه المصروف -->
      <button class="btn btn-sm px-4 rounded-sm font-normal h-8 min-h-0"
              style="background-color: var(--surface-hover); color: var(--text-color); border-color: var(--surface-border);"
              (click)="directExpense()">
        توجيه المصروف
      </button>

    </div>

    <!-- الجانب الأيسر: زر تم الاستلام -->
    <button class="btn btn-sm px-4 rounded-sm font-normal h-8 min-h-0"
            style="background-color: var(--surface-hover); color: var(--text-color); border-color: var(--surface-border);"
            (click)="markReceived()">
      تم الاستلام
    </button>
  </div>

  <!-- ========================================== -->
  <!-- 2. الجدول -->
  <!-- ========================================== -->
  <div class="flex-grow overflow-auto border-b relative"
       style="background-color: var(--surface-card); border-color: var(--surface-border);">
    <table class="table table-xs table-pin-rows w-full border-collapse text-right">
      <thead>
        <tr class="border-b"
            style="background-color: var(--surface-section); border-color: var(--surface-border); color: var(--text-color);">
           <th class="border-r w-12 text-center" style="border-color: var(--surface-border);">م</th>
           <th class="border-r" style="border-color: var(--surface-border);">اسم الشركة</th>
           <th class="border-r" style="border-color: var(--surface-border);">رقم الكشف</th>
           <th class="border-r" style="border-color: var(--surface-border);">المبلغ</th>
           <th class="border-r" style="border-color: var(--surface-border);">التاريخ</th>
           <th class="border-r" style="border-color: var(--surface-border);">الشركة</th>
           <th class="border-r" style="border-color: var(--surface-border);">المكتب</th>
        </tr>
      </thead>
      <tbody>
         <!-- محتوى فارغ كما في الصورة -->
      </tbody>
    </table>
  </div>

  <!-- ========================================== -->
  <!-- 3. التذييل (Footer) -->
  <!-- ========================================== -->
  <div class="border-t p-1 px-4 text-xs font-bold flex items-center justify-center gap-2"
       style="background-color: var(--surface-section); border-color: var(--surface-border); color: var(--text-color);">
      <span>اجمالي العهدة</span>
      <span class="font-mono" style="color: var(--primary-color);">{{ totalCustody }}</span>
  </div>

</div>

<!-- ========================================== -->
<!-- 4. استدعاء المودال (مخفي افتراضياً) -->
<!-- ========================================== -->
<app-lookup-modal
  #employeeLookup
  [title]="'بحث عن موظف'"
  [data]="employeesData"
  [columns]="['code', 'name', 'department']"
  (itemSelected)="onEmployeeSelected($event)">
</app-lookup-modal>