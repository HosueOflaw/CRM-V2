<p-toast></p-toast>
<app-dashboard-layout [title]="' ูุณู ุงูุณูุฑุชุงุฑูุฉ'" [subtitle]="'ุงุฎุชุฑ ุงูุนูููุฉ ุงูุชู ุชุฑุบุจ ูู ุชูููุฐูุง'"
  [actions]="actions"></app-dashboard-layout>

<!-- Modal: ุงุฎุชูุงุฑ ุทุฑููุฉ ุงูุฅุฏุฎุงู -->
<dialog class="modal" [open]="showCommonDialog">
  <div class="modal-box modal-md">
    <div class="modal-header">
      <h3>ุงุฎุชูุงุฑ ุทุฑููุฉ ุฅุฏุฎุงู {{currentFormTitle}}</h3>
      <button class="modal-close" (click)="cancelCommonOption()">โ</button>
    </div>

    <div class="modal-body">
      <div class="radio-group">
        <label *ngIf="showOptions.onlyOne" [class.selected]="selectedOption === 'onlyOne'">
          <input type="radio" name="payOption" value="onlyOne" [(ngModel)]="selectedOption" />
          <span>ูุงุญุฏ ููุท</span>
        </label>

        <label *ngIf="showOptions.manual" [class.selected]="selectedOption === 'manual'">
          <input type="radio" name="payOption" value="manual" [(ngModel)]="selectedOption" />
          <span>ุชุนุฏูู ุงูุฑูู ุงูุขูู ุจุฏูู ุงูุณูู</span>
        </label>

        <label *ngIf="showOptions.excel" [class.selected]="selectedOption === 'excel'">
          <input type="radio" name="payOption" value="excel" [(ngModel)]="selectedOption" />
          <span>ุงูุณูู</span>
        </label>
      </div>
    </div>

    <div class="modal-footer">
      <button class="form-button form-button-danger" (click)="cancelCommonOption()">ุฅูุบุงุก</button>
      <button class="form-button form-button-success" (click)="confirmCommonOption()">ุชุฃููุฏ</button>
    </div>
  </div>
</dialog>

<!-- Modal: ุงุฏุฎุงู ุจูุงูุงุช ุงูุณุฏุงุฏ -->
<dialog class="modal" [open]="showOnlyOne">
  <div class="modal-box modal-lg">
    <div class="modal-header">
      <h3>ุงุฏุฎุงู ุจูุงูุงุช ุงูุณุฏุงุฏ (ูุงุญุฏ ููุท)</h3>
      <button class="modal-close" (click)="cancelSingleForm()">โ</button>
    </div>

    <div class="modal-body">
      <form class="form-grid form-grid-2">
        <div class="form-field">
          <label class="form-label">ุฑูู ID</label>
          <input type="text" class="form-input" [(ngModel)]="singlePaymentForm.id" name="id">
        </div>

        <div class="form-field">
          <label class="form-label">ุงูููุฏ</label>
          <input type="text" class="form-input" [(ngModel)]="singlePaymentForm.code" name="code">
        </div>

        <div class="form-field">
          <label class="form-label">ุงููุจูุบ</label>
          <input type="number" class="form-input" [(ngModel)]="singlePaymentForm.amount" name="amount">
        </div>

        <div class="form-field">
          <label class="form-label">ุงูุชุงุฑูุฎ</label>
          <input type="date" class="form-input" [(ngModel)]="singlePaymentForm.date" name="date">
        </div>

        <div class="form-field">
          <label class="form-label">ุงูููุธู</label>
          <input type="text" class="form-input" [(ngModel)]="singlePaymentForm.employee" name="employee">
        </div>

        <div class="form-field form-field-full">
          <label class="form-label">ููุงุญุธุงุช</label>
          <textarea class="form-textarea" rows="3" [(ngModel)]="singlePaymentForm.notes" name="notes"></textarea>
        </div>
      </form>
    </div>

    <div class="modal-footer">
      <button class="form-button form-button-primary" (click)="saveSingleForm()">ุญูุธ</button>
      <button class="form-button form-button-warning" (click)="editSingleForm()">ุชุนุฏูู</button>
      <button class="form-button form-button-secondary" (click)="cancelSingleForm()">ุฅูุบุงุก</button>
    </div>
  </div>
</dialog>

<!-- Modal: ุชุนุฏูู ุงูุฑูู ุงูุขูู -->
<dialog class="modal" [open]="showEditForm">
  <div class="modal-box modal-xl">
    <div class="modal-header">
      <h3>ุชุนุฏูู ุงูุฑูู ุงูุขูู</h3>
      <button class="modal-close" (click)="showEditForm = false">โ</button>
    </div>

    <div class="modal-body">
      <div class="form-row mb-4">
        <div class="form-field" style="flex: 1;">
          <label class="form-label">ุงูููุฏ</label>
          <input type="text" class="form-input" placeholder="ุงูุชุจ ุงูููุฏ" [(ngModel)]="searchCode"
            (ngModelChange)="fetchCodeData()" name="searchCode">
        </div>
        <button class="form-button form-button-primary" (click)="editSelectedRow()">ุชุนุฏูู</button>
      </div>

      <div class="overflow-x-auto">
        <table class="table">
          <thead>
            <tr>
              <th>_id</th>
              <th>ุงูููุฏ</th>
              <th>ุงูุฑูู ุงูุขูู ุงูุฑุฆูุณู</th>
              <th>ุงูุฑูู ุงูุขูู ุงููุฑุชุจุท</th>
              <th>ุงูููุน</th>
              <th>ุงูุญุงูุฉ</th>
              <th>ุงูุงุฏุนุงุก</th>
              <th>ููุงุญุธุงุช</th>
              <th>ูุฏุฎู ุงูุฑูู ุงูุขูู</th>
              <th>ุงููููู</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let row of codeData">
              <td>{{ row._id }}</td>
              <td>{{ row.code }}</td>
              <td>{{ row.mainNumber }}</td>
              <td>{{ row.relatedNumber }}</td>
              <td>{{ row.type }}</td>
              <td>{{ row.status }}</td>
              <td>{{ row.claim }}</td>
              <td>{{ row.notes }}</td>
              <td>{{ row.enteredBy }}</td>
              <td>{{ row.client }}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="modal-footer">
      <button class="form-button form-button-primary" (click)="saveChanges()">ุญูุธ</button>
      <button class="form-button form-button-secondary" (click)="showEditForm = false">ุฅุบูุงู</button>
    </div>
  </div>
</dialog>

<!-- Modal: ุชุนุฏูู ุงูุฑูู ุงูุขูู (ุจุณูุท) -->
<dialog class="modal" [open]="showEditFormOnly">
  <div class="modal-box modal-sm">
    <div class="modal-header">
      <h3>ุชุนุฏูู ุงูุฑูู ุงูุขูู</h3>
      <button class="modal-close" (click)="cancelEditForm()">โ</button>
    </div>

    <div class="modal-body">
      <form class="form-grid">
        <div class="form-field">
          <label class="form-label">ุงูููุฏ</label>
          <div style="display: flex; gap: 0.5rem; align-items: center;">
            <input type="text" class="form-input" [(ngModel)]="editFormData.code" (keydown.enter)="searchAutoNumber()"
              name="code" placeholder="ุฃุฏุฎู ุงูููุฏ" style="flex: 1;">
            <button type="button" class="form-button form-button-secondary" (click)="searchAutoNumber()">ุจุญุซ</button>
          </div>
        </div>

        <div class="form-field">
          <label class="form-label">ุงูุฑูู ุงูุขูู</label>
          <input type="text" class="form-input" [(ngModel)]="editFormData.autoNumber" name="autoNumber">
        </div>
      </form>
    </div>

    <div class="modal-footer">
      <button class="form-button form-button-warning" (click)="editAutoNumber()">ุชุนุฏูู</button>
      <button class="form-button form-button-secondary" (click)="cancelEditForm()">ุฅูุบุงุก</button>
    </div>
  </div>
</dialog>

<!-- Modal: ุฅุบูุงู ุงููููุงุช -->
<dialog class="modal" [open]="showexitfile">
  <div class="modal-box modal-sm">
    <div class="modal-header">
      <h3>ุฅุบูุงู ุงููููุงุช</h3>
      <button class="modal-close" (click)="exitfile()">โ</button>
    </div>

    <div class="modal-body">
      <form class="form-grid">
        <div class="form-field">
          <label class="form-label">ุงูููุฏ</label>
          <input type="text" class="form-input" [(ngModel)]="editFormData.code" name="code">
        </div>

        <div class="form-field">
          <label class="form-label">ุงูุญุงูุฉ</label>
          <select class="form-select" [(ngModel)]="editFormData.status" name="status">
            <option value="">ุงุฎุชุฑ ุงูุญุงูุฉ</option>
            <option value="ุฅุบูุงู">ุฅุบูุงู</option>
            <option value="ุฅุนุงุฏุฉ">ุฅุนุงุฏุฉ</option>
          </select>
        </div>
      </form>
    </div>

    <div class="modal-footer">
      <button class="form-button form-button-warning" (click)="editAutoNumber()">ุชุนุฏูู</button>
      <button class="form-button form-button-secondary" (click)="exitfile()">ุฅูุบุงุก</button>
    </div>
  </div>
</dialog>

<!-- Modal: ุงุถุงูุฉ ุงููุฏุนู ุงููุงูููู -->
<dialog class="modal" [open]="showAddPlaintiffModal">
  <div class="modal-box modal-md">
    <div class="modal-header">
      <h3>๐๏ธ ุงุถุงูุฉ ุงููุฏุนู ุงููุงูููู</h3>
      <button class="modal-close" (click)="closePlaintiffDialog()">โ</button>
    </div>

    <div class="modal-body">
      <form class="form-grid">
        <div class="form-field">
          <label class="form-label">ุงูููุฏ</label>
          <input type="text" class="form-input" [(ngModel)]="plaintiffForm.code" name="code">
        </div>

        <div class="form-field">
          <label class="form-label">ุงููุฏุนู</label>
          <input type="text" class="form-input" [(ngModel)]="plaintiffForm.name" name="name">
        </div>
      </form>
    </div>

    <div class="modal-footer modal-footer-center">
      <button class="form-button form-button-secondary" (click)="newPlaintiff()">ุฌุฏูุฏ</button>
      <button class="form-button form-button-success" (click)="addPlaintiff()">ุงุถุงูุฉ</button>
      <button class="form-button form-button-warning" (click)="updatePlaintiff()">ุชุนุฏูู</button>
    </div>
  </div>
</dialog>

<!-- Modal: ุชุนุฏูู ุงููุฏุนู ุงููุงูููู ููููู -->
<dialog class="modal" [open]="showEditPlaintiffFileModal">
  <div class="modal-box modal-md">
    <div class="modal-header">
      <h3>โ๏ธ ุชุนุฏูู ุงููุฏุนู ุงููุงูููู ููููู</h3>
      <button class="modal-close" (click)="closeEditPlaintiffFileDialog()">โ</button>
    </div>

    <div class="modal-body">
      <form class="form-grid">
        <div class="form-field">
          <label class="form-label">ููุฏ ุงูุฎุตู</label>
          <input type="text" class="form-input" [(ngModel)]="editPlaintiffFileForm.opponentCode" name="opponentCode">
        </div>

        <div class="form-field">
          <label class="form-label">ููุฏ ุงููุฏุนู ุงููุงูููู</label>
          <input type="text" class="form-input" [(ngModel)]="editPlaintiffFileForm.plaintiffCode" name="plaintiffCode">
        </div>
      </form>
    </div>

    <div class="modal-footer">
      <button class="form-button form-button-primary" (click)="saveEditPlaintiffFile()">ุชุนุฏูู</button>
      <button class="form-button form-button-secondary" (click)="closeEditPlaintiffFileDialog()">ุฅูุบุงุก</button>
    </div>
  </div>
</dialog>

<!-- Modal: ุชุนุฏูู ููุฏ ูููุธู -->
<dialog class="modal" [open]="showEditEmployeeCodeModal">
  <div class="modal-box modal-sm">
    <div class="modal-header">
      <h3>ุชุนุฏูู ููุฏ ูููุธู</h3>
      <button class="modal-close" (click)="closeEditEmployeeCodeDialog()">โ</button>
    </div>

    <div class="modal-body">
      <form class="form-grid">
        <div class="form-field">
          <label class="form-label">ุงูููุฏ</label>
          <input type="text" class="form-input" [(ngModel)]="editEmployeeCodeForm.code" name="code">
        </div>

        <div class="form-field">
          <label class="form-label">ุฑูู ุงูููุธู</label>
          <input type="text" class="form-input" [(ngModel)]="editEmployeeCodeForm.employeeNumber" name="employeeNumber">
        </div>
      </form>
    </div>

    <div class="modal-footer">
      <button class="form-button form-button-success" (click)="saveEditEmployeeCode()">ุชุนุฏูู</button>
      <button class="form-button form-button-secondary" (click)="closeEditEmployeeCodeDialog()">ุฅูุบุงุก</button>
    </div>
  </div>
</dialog>

<!-- Modal: ุงุถุงูุฉ ุฑูู ุงูู -->
<dialog class="modal" [open]="showAddAutoNumberModal">
  <div class="modal-box modal-lg">
    <div class="modal-header">
      <h3>ุงุถุงูุฉ ุฑูู ุงูู</h3>
      <button class="modal-close" (click)="closeAutoNumberDialog()">โ</button>
    </div>

    <div class="modal-body">
      <form class="form-grid form-grid-2">
        <div class="form-field">
          <label class="form-label">ุงูููุฏ</label>
          <input type="text" class="form-input" [(ngModel)]="autoNumberForm.code" name="code">
        </div>

        <div class="form-field">
          <label class="form-label">ุงูุฑูู ุงูุขูู</label>
          <input type="text" class="form-input" [(ngModel)]="autoNumberForm.autoNumber" name="autoNumber">
        </div>

        <div class="form-field">
          <label class="form-label">ูุฑุชุจุท ุจู</label>
          <input type="number" class="form-input" [(ngModel)]="autoNumberForm.relatedTo" name="relatedTo">
        </div>

        <div class="form-field">
          <label class="form-label">ุงูููุน</label>
          <select class="form-select" [(ngModel)]="autoNumberForm.type" name="type">
            <option value="">ุงุฎุชุฑ ุงูููุน</option>
            <option value="type1">ููุน 1</option>
            <option value="type2">ููุน 2</option>
          </select>
        </div>

        <div class="form-field">
          <label class="form-label">ุงูุงุฏุนุงุก</label>
          <select class="form-select" [(ngModel)]="autoNumberForm.claim" name="claim">
            <option value="">ุงุฎุชุฑ ุงูุงุฏุนุงุก</option>
            <option value="claim1">ุงุฏุนุงุก 1</option>
            <option value="claim2">ุงุฏุนุงุก 2</option>
          </select>
        </div>

        <div class="form-field">
          <label class="form-label">ุงูุญุงูุฉ</label>
          <select class="form-select" [(ngModel)]="autoNumberForm.status" name="status">
            <option value="">ุงุฎุชุฑ ุงูุญุงูุฉ</option>
            <option value="active">ูุดุท</option>
            <option value="inactive">ุบูุฑ ูุดุท</option>
          </select>
        </div>

        <div class="form-field form-field-full">
          <label class="form-label">ููุงุญุธุงุช</label>
          <textarea class="form-textarea" rows="3" [(ngModel)]="autoNumberForm.notes" name="notes"></textarea>
        </div>
      </form>
    </div>

    <div class="modal-footer">
      <button class="form-button form-button-primary" (click)="saveAutoNumber()">ุญูุธ</button>
      <button class="form-button form-button-secondary" (click)="resetAutoNumberForm()">ุชุฑุงุฌุน</button>
      <button class="form-button form-button-secondary" (click)="closeAutoNumberDialog()">ุฅูุบุงุก</button>
    </div>
  </div>
</dialog>

<!-- Modal: ุฅุถุงูุฉ ุชุตููู ุฌุฏูุฏ -->
<dialog class="modal" [open]="showAddClassificationModal">
  <div class="modal-box modal-md">
    <div class="modal-header">
      <h3>๐๏ธ ุฅุถุงูุฉ ุชุตููู ุฌุฏูุฏ</h3>
      <button class="modal-close" (click)="closeClassificationDialog()">โ</button>
    </div>

    <div class="modal-body">
      <form class="form-grid">
        <div class="form-field">
          <label class="form-label">ุงูุชุณูุณู</label>
          <input type="text" class="form-input" [(ngModel)]="classificationForm.sequence" name="sequence" readonly>
        </div>

        <div class="form-field">
          <label class="form-label">ุงูุชุตููู</label>
          <input type="text" class="form-input" [(ngModel)]="classificationForm.name" name="name">
        </div>

        <div class="form-field">
          <label class="form-label">ุงูุญุงูุฉ</label>
          <select class="form-select" [(ngModel)]="classificationForm.status" name="status">
            <option value="">ุงููุณู</option>
            <option value="active">ูุดุท</option>
            <option value="inactive">ุบูุฑ ูุดุท</option>
          </select>
        </div>
      </form>
    </div>

    <div class="modal-footer modal-footer-center">
      <button class="form-button form-button-secondary" (click)="resetForm()">ุชุฑุงุฌุน</button>
      <button class="form-button form-button-warning" (click)="updateClassification()">ุชุนุฏูู</button>
      <button class="form-button form-button-primary" (click)="saveClassification()">ุญูุธ</button>
    </div>
  </div>
</dialog>