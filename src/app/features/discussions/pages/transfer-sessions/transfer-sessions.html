
<div class="sessions p-4 space-y-6">
  <h2 class="text-lg font-bold text-center text-primary">๐ ุชุฑุญูู ุงูุฌูุณุงุช</h2>

  <!-- ๐น ุฃุฒุฑุงุฑ ุงูุนูููุงุช -->
  <div class="flex justify-center gap-3 mt-4">
    <button class="btn btn-outline btn-info btn-sm" (click)="openSearchModal()">๐ ุจุญุซ</button>
    <button class="btn btn-outline btn-warning btn-sm" (click)="openJudgmentModal()">โ๏ธ ุงูุฃุญูุงู</button>
    <button class="btn btn-outline btn-accent btn-sm" (click)="openAttachmentModal()">๐ ุงููุฑููุงุช</button>
    <button class="btn btn-outline btn-success btn-sm" (click)="printReport()">๐จ๏ธ ุทุจุงุนุฉ</button>
  </div>

  <!-- ๐ธ Tabs ุงูุฑุฆูุณูุฉ -->
  <div role="tablist" class="tabs tabs-boxed w-full mt-6">
    <a role="tab" class="tab" [class.tab-active]="activeTab==='sessions'" (click)="activeTab='sessions'">ุงูุฌูุณุงุช</a>
    <a role="tab" class="tab" [class.tab-active]="activeTab==='file'" (click)="activeTab='file'">ููุงู ุงูููู</a>
    <a role="tab" class="tab" [class.tab-active]="activeTab==='admin'" (click)="activeTab='admin'">ุงูุนูู ุงูุฅุฏุงุฑู</a>
  </div>

  <div class="sessions p-4 space-y-6">

  <!-- ุงูุฌูุณุงุช -->
  <div *ngIf="activeTab==='sessions'" class="space-y-4 p-3 border rounded-lg bg-gray-50">
    <form [formGroup]="sessionForm" class="space-y-4">

    <div class="grid grid-cols-3 gap-3">
      <div>
        <label class="label"><span class="label-text">ุงูุฌูุณุฉ ุงูุญุงููุฉ</span></label>
        <input type="date" formControlName="currentSession" class="input input-bordered input-sm w-full" />
      </div>

      <div>
        <label class="label"><span class="label-text">ุงูุฌูุณุฉ ุงููุงุฏูุฉ</span></label>
        <input type="date" formControlName="nextSession" class="input input-bordered input-sm w-full" />
      </div>
    </div>

    <div>
      <label class="label"><span class="label-text">ููุงุญุธุงุช</span></label>
      <textarea formControlName="sessionNotes" class="textarea textarea-bordered w-full h-24"></textarea>
    </div>

    <div class="flex justify-end">
      <button class="btn btn-success btn-sm">ุญูุธ</button>
    </div>
    </form>
    <!-- Tabs ุฏุงุฎู ุงูุฌูุณุงุช -->
    <div role="tablist" class="tabs tabs-lifted mt-5">
      <a role="tab" class="tab" [class.tab-active]="subTab==='court'" (click)="subTab='court'">ุฌูุณุงุช ุงููุญููุฉ</a>
      <a role="tab" class="tab" [class.tab-active]="subTab==='experts'" (click)="subTab='experts'">ุฌูุณุงุช ุงูุฎุจุฑุงุก</a>
    </div>

    <div *ngIf="subTab==='court'" class="overflow-x-auto border rounded-lg mt-2 bg-white">
      <table class="table table-zebra w-full text-center">
        <thead>
          <tr>
            <th>ID</th>
            <th>ุชุงุฑูุฎ ุงูุฅูุงุฏุฉ</th>
            <th>ููุน ุงูุฌูุณุฉ</th>
            <th>ุงููุฑุงุฑ</th>
            <th>ุงูุฌูุณุฉ ุงููุงุฏูุฉ</th>
            <th>ุชูููุช ุงูุฎุจุฑุงุก</th>
            <th>ููุงุญุธุงุช</th>
            <th>ุงููุณุชุฎุฏู</th>
            <th>ุชุนุฏูู</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let s of courtSessions">
            <td>{{s.id}}</td>
            <td>{{s.reportDate}}</td>
            <td>{{s.type}}</td>
            <td>{{s.decision}}</td>
            <td>{{s.nextDate}}</td>
            <td>{{s.expertTime}}</td>
            <td>{{s.notes}}</td>
            <td>{{s.user}}</td>
            <td><button class="btn btn-xs btn-warning">ุชุนุฏูู</button></td>
          </tr>
        </tbody>
      </table>
    </div>

    <div *ngIf="subTab==='experts'" class="overflow-x-auto border rounded-lg mt-2 bg-white">
      <table class="table table-zebra w-full text-center">
        <thead>
          <tr>
            <th>ID</th>
            <th>ุชุงุฑูุฎ ุงูุฅูุงุฏุฉ</th>
            <th>ููุน ุงูุฌูุณุฉ</th>
            <th>ุงููุฑุงุฑ</th>
            <th>ุงูุฌูุณุฉ ุงููุงุฏูุฉ</th>
            <th>ุชูููุช ุงูุฎุจุฑุงุก</th>
            <th>ููุงุญุธุงุช</th>
            <th>ุงููุณุชุฎุฏู</th>
            <th>ุชุนุฏูู</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let s of expertSessions">
            <td>{{s.id}}</td>
            <td>{{s.reportDate}}</td>
            <td>{{s.type}}</td>
            <td>{{s.decision}}</td>
            <td>{{s.nextDate}}</td>
            <td>{{s.expertTime}}</td>
            <td>{{s.notes}}</td>
            <td>{{s.user}}</td>
            <td><button class="btn btn-xs btn-warning">ุชุนุฏูู</button></td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>

  <!-- ููุงู ุงูููู -->
<div *ngIf="activeTab==='file'" class="space-y-4 p-3 border rounded-lg bg-gray-50">
  <form class="space-y-4">
    <!-- ุญูู ุงุฎุชูุงุฑ ููุงู ุงูููู -->
    <div class="flex items-end gap-2">
      <div class="flex-1">
        <label class="label"><span class="label-text">๐ ููุงู ุงูููู</span></label>
        <input type="text" class="input input-bordered input-sm w-full" [(ngModel)]="fileLocation" name="fileLocation" readonly />
      </div>
      <button type="button" class="btn btn-outline btn-sm" (click)="openSectionModal()">...</button>
    </div>

    <!-- ููุงุญุธุงุช -->
    <div>
      <label class="label"><span class="label-text">ููุงุญุธุงุช</span></label>
      <textarea class="textarea textarea-bordered w-full h-24" [(ngModel)]="fileNotes" name="fileNotes"></textarea>
    </div>

    <div class="flex justify-end">
      <button type="button" class="btn btn-success btn-sm" (click)="saveFileLocation()">๐พ ุญูุธ</button>
    </div>
  </form>

  <!-- ุฌุฏูู ุนุฑุถ -->
  <div class="overflow-x-auto border rounded-lg mt-4 bg-white">
    <table class="table table-zebra w-full text-center">
      <thead>
        <tr>
          <th>๐ ุชุงุฑูุฎ ุงูุฅูุงุฏุฉ</th>
          <th>๐ ููุงู ุงูููู</th>
          <th>๐ ุงูููุงุญุธุงุช</th>
          <th>๐ค ุงููุณุชุฎุฏู</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let item of fileLocations">
          <td>{{ item.date }}</td>
          <td>{{ item.location }}</td>
          <td>{{ item.notes }}</td>
          <td>{{ item.user }}</td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- ููุฏุงู ุงุฎุชูุงุฑ ุงููุณู -->
  <dialog #sectionModal class="modal">
    <div class="modal-box">
      <h3 class="font-bold text-lg mb-4">ุงุฎุชูุงุฑ ุงููุณู</h3>

      <div class="space-y-2">
        <button *ngFor="let section of sections"
          class="btn btn-outline btn-block"
          (click)="selectSection(section)">
          {{ section }}
        </button>
      </div>

      <div class="modal-action">
        <button class="btn" (click)="sectionModal.close()">ุฅุบูุงู</button>
      </div>
    </div>
  </dialog>
</div>


  <!-- ุงูุนูู ุงูุฅุฏุงุฑู -->
<div *ngIf="activeTab==='admin'" class="space-y-4 p-3 border rounded-lg bg-gray-50">
  <form class="space-y-4">
    <!-- ููุช ุงููุฑุงุฌุนุฉ -->
    <div>
      <label class="label"><span class="label-text">๐ ููุช ุงููุฑุงุฌุนุฉ</span></label>
      <input type="datetime-local" class="input input-bordered input-sm w-full" [(ngModel)]="reviewTime" name="reviewTime" />
    </div>

    <!-- ููุงุญุธุงุช -->
    <div>
      <label class="label"><span class="label-text">ููุงุญุธุงุช</span></label>
      <textarea class="textarea textarea-bordered w-full h-24" [(ngModel)]="adminNotes" name="adminNotes"></textarea>
    </div>

    <!-- ุฒุฑ ุญูุธ -->
    <div class="flex justify-end">
      <button type="button" class="btn btn-success btn-sm" (click)="saveAdminTask()">๐พ ุญูุธ</button>
    </div>
  </form>

  <!-- ุฌุฏูู ุนุฑุถ -->
  <div class="overflow-x-auto border rounded-lg mt-4 bg-white">
    <table class="table table-zebra w-full text-center">
      <thead>
        <tr>
          <th>๐ ุงูุชุงุฑูุฎ</th>
          <th>โ๏ธ ุงูุฅุฏุงุฑู</th>
          <th>๐ ุชุงุฑูุฎ ุงููุฑุงุฌุนุฉ</th>
          <th>๐ค ุงูููุธู</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let a of adminTasks">
          <td>{{ a.date }}</td>
          <td>{{ a.notes }}</td>
          <td>{{ a.reviewTime }}</td>
          <td>{{ a.user }}</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

</div>
<app-report-template
  #report
    class="print-only"
  [caseData]="expertSessions"
  [expertSessions]="expertSessions"
  [courtSessions]="courtSessions">
</app-report-template>
</div>



<!-- ๐น ููุฏุงู ุงูุจุญุซ -->
<dialog #searchModal class="modal">
  <div class="modal-box max-w-4xl">
    <h3 class="font-bold text-lg mb-4 text-center">๐ ุจุญุซ ุนู ุงููุถุงูุง</h3>

    <div class="grid grid-cols-2 md:grid-cols-3 gap-3">
      <div *ngFor="let field of searchFields">
        <label class="label"><span class="label-text">{{ field.label }}</span></label>
        <div class="flex items-center gap-2">
          <input [(ngModel)]="field.value" type="text" class="input input-bordered input-sm w-full" />
          <button class="btn btn-outline btn-sm">ุจุญุซ</button>
        </div>
      </div>
    </div>

    <!-- Tabs ูุชุงุฆุฌ ุงูุจุญุซ -->
    <div class="mt-5">
      <div role="tablist" class="tabs tabs-lifted">
        <a role="tab" class="tab" [class.tab-active]="searchTab==='current'" (click)="searchTab='current'">ุงูุจุญุซ ูู ุงููุชุฏุงูู</a>
        <a role="tab" class="tab" [class.tab-active]="searchTab==='results'" (click)="searchTab='results'">ูุชุงุฆุฌ ุงูุจุญุซ</a>
      </div>

      <div *ngIf="searchTab==='current'" class="p-3">
        <p class="text-gray-500 text-center">๐ ุงุจุญุซ ูู ุงููุถุงูุง ุงููุชุฏุงููุฉ</p>
      </div>

      <div *ngIf="searchTab==='results'" class="overflow-x-auto border rounded-lg bg-white mt-3">
        <table class="table table-zebra w-full text-center">
          <thead>
            <tr>
              <th>๐ ุงูููุฏ</th>
              <th>๐ ุฑูู ุงููุถูุฉ</th>
              <th>๐ค ุงููููู</th>
              <th>โ๏ธ ุงูุฎุตู</th>
              <th>๐ ุงูุชุงุฑูุฎ</th>
              <th>๐ ุงููุญููุฉ</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let result of searchResults">
              <td>{{ result.code }}</td>
              <td>{{ result.caseNumber }}</td>
              <td>{{ result.client }}</td>
              <td>{{ result.opponent }}</td>
              <td>{{ result.date }}</td>
              <td>{{ result.court }}</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div class="modal-action">
      <button class="btn" (click)="searchModal.close()">ุฅุบูุงู</button>
    </div>
  </div>
</dialog>

<!-- ๐น ููุฏุงู ุงูุฃุญูุงู -->
<dialog #judgmentModal class="modal">
  <div class="modal-box max-w-3xl">
    <h3 class="font-bold text-lg mb-4 text-center">โ๏ธ ููุทูู ุงูุญูู</h3>
    <div class="overflow-x-auto border rounded-lg bg-white">
      <table class="table table-zebra w-full text-center">
        <thead>
          <tr>
            <th>ููุทูู ุงูุญูู</th>
            <th>ุชุงุฑูุฎ ุงูุญูู</th>
            <th>ุฏุฑุฌุฉ ุงูุชูุงุถู</th>
            <th>ููุน ุงูุญูู</th>
            <th>ุงููุญููุฉ</th>
            <th>๐ ุงููุฑูู</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let j of judgments">
            <td>{{ j.text }}</td>
            <td>{{ j.date }}</td>
            <td>{{ j.level }}</td>
            <td>{{ j.type }}</td>
            <td>{{ j.court }}</td>
            <td><button class="btn btn-outline btn-xs">ูุชุญ</button></td>
          </tr>
        </tbody>
      </table>
    </div>
    <div class="modal-action">
      <button class="btn" (click)="judgmentModal.close()">ุฅุบูุงู</button>
    </div>
  </div>
</dialog>

<!-- ๐น ููุฏุงู ุงููุฑููุงุช -->
<dialog #attachmentModal class="modal">
  <div class="modal-box max-w-md">
    <h3 class="font-bold text-lg mb-4 text-center">๐ ุฅุถุงูุฉ ูุฑูู</h3>

    <form class="space-y-4">
      <div>
        <label class="label"><span class="label-text">ุงูุจูุงู</span></label>
        <input type="text" class="input input-bordered input-sm w-full" [(ngModel)]="attachment.statement" name="statement" />
      </div>

      <div>
        <label class="label"><span class="label-text">ุงููุฑูู</span></label>
        <input type="file" class="file-input file-input-bordered file-input-sm w-full" (change)="onFileSelected($event)" />
      </div>

      <div class="flex justify-end gap-2">
        <button type="button" class="btn btn-success btn-sm" (click)="saveAttachment()">๐พ ุญูุธ</button>
        <button type="button" class="btn btn-warning btn-sm" (click)="updateAttachment()">โ๏ธ ุชุนุฏูู</button>
      </div>
    </form>

    <div class="modal-action">
      <button class="btn" (click)="attachmentModal.close()">ุฅุบูุงู</button>
    </div>
  </div>
</dialog>



