<div class="p-4 md:p-6 bg-gray-50 min-h-screen" dir="rtl">

  <!-- العنوان الرئيسي -->
  <h1 class="text-2xl font-bold text-gray-800 mb-6 border-b pb-2">
    تقرير أداء الشركات
  </h1>

  <!-- Header: فلاتر التقرير -->
  <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-4 gap-4 bg-white p-4 rounded-xl shadow-lg">

    <!-- من تاريخ -->
    <div class="flex flex-col">
      <label class="font-bold text-sm text-gray-700 mb-1">من تاريخ</label>
      <input
        type="date"
        [ngModel]="fromDate()"
        (ngModelChange)="fromDate.set($event)"
        class="p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition cursor-pointer"
      />
    </div>

    <!-- الي تاريخ -->
    <div class="flex flex-col">
      <label class="font-bold text-sm text-gray-700 mb-1">الى تاريخ</label>
      <input
        type="date"
        [ngModel]="toDate()"
        (ngModelChange)="toDate.set($event)"
        class="p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition cursor-pointer"
      />
    </div>

    <!-- اختيار القطاع -->
    <div class="flex flex-col">
      <label class="font-bold text-sm text-gray-700 mb-1">القطاع</label>
      <select
        [ngModel]="selectedSector()"
        (ngModelChange)="selectedSector.set($event)"
        class="p-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition appearance-none bg-white cursor-pointer"
      >
        <!-- قائمة القطاعات الطويلة -->
        @for (sector of sectors; track sector.value) {
          <option [value]="sector.value">{{ sector.label }}</option>
        }
      </select>
    </div>

    <!-- زر تحميل التقرير -->
    <div class="col-span-2 md:col-span-1 flex items-end justify-start md:justify-end mt-4 md:mt-0">
      <button
        (click)="loadReports()"
        class="bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-lg transition shadow-md hover:shadow-lg text-sm font-semibold whitespace-nowrap">
        عرض التقرير
      </button>
    </div>

  </div>

  <!-- جدول التقرير -->
  @if (reportData().length) {
    <div class="mt-6 overflow-x-auto bg-white shadow-lg rounded-xl border border-gray-200">
      <!-- جعل الجدول عريضاً جداً ليحتوي الأعمدة الكثيرة -->
      <table class="w-[3000px] xl:w-full text-right border-collapse text-sm">

        <!-- رأس الجدول - 25 عموداً -->
        <thead>
          <tr class="bg-gray-100 text-gray-700 border-b border-gray-300 font-semibold sticky top-0">
            <th class="p-3 whitespace-nowrap border-l min-w-[120px]">الموكل</th>
            <th class="p-3 whitespace-nowrap border-l min-w-[100px]">عدد الملفات</th>
            <th class="p-3 whitespace-nowrap border-l min-w-[150px]">قيمة المطالبة</th>
            <th class="p-3 whitespace-nowrap border-l min-w-[120px]">المدفوع</th>
            <th class="p-3 whitespace-nowrap border-l min-w-[120px]">المتبقي</th>
            <th class="p-3 whitespace-nowrap border-l min-w-[150px]">غير قابل للتحصيل</th>
            <th class="p-3 whitespace-nowrap border-l min-w-[150px]">غير قابل للتحصيل (موزع)</th>
            <th class="p-3 whitespace-nowrap border-l min-w-[150px]">غير قابل للتحصيل (غير موزع)</th>
            <th class="p-3 whitespace-nowrap border-l min-w-[120px]">قابل للتحصيل</th>
            <th class="p-3 whitespace-nowrap border-l min-w-[150px]">قابل للتحصيل (موزع)</th>
            <th class="p-3 whitespace-nowrap border-l min-w-[170px]">قابل للتحصيل (متواصل)</th>
            <th class="p-3 whitespace-nowrap border-l min-w-[170px]">قابل للتحصيل (غير متواصل)</th>
            <th class="p-3 whitespace-nowrap border-l min-w-[200px]">قابل للتحصيل (لا يمكن التواصل)</th>
            <th class="p-3 whitespace-nowrap border-l min-w-[200px]">قابل للتحصيل (متواصل مع اخر)</th>
            <th class="p-3 whitespace-nowrap border-l min-w-[170px]">قابل للتحصيل (غير مصنف)</th>
            <th class="p-3 whitespace-nowrap border-l min-w-[150px]">قابل للتحصيل (متابع)</th>
            <th class="p-3 whitespace-nowrap border-l min-w-[170px]">قابل للتحصيل (غير متابع)</th>
            <th class="p-3 whitespace-nowrap border-l min-w-[200px]">قابل للتحصيل (لم يتم الإتصال)</th>
            <th class="p-3 whitespace-nowrap border-l min-w-[180px]">قابل للتحصيل (غير موزع)</th>
            <th class="p-3 whitespace-nowrap border-l min-w-[100px]">تنفيذ</th>
            <th class="p-3 whitespace-nowrap border-l min-w-[130px]">متابع تنفيذ</th>
            <th class="p-3 whitespace-nowrap border-l min-w-[150px]">غير متابع تنفيذ</th>
            <th class="p-3 whitespace-nowrap border-l min-w-[100px]">الرسوم</th>
            <th class="p-3 whitespace-nowrap border-l min-w-[100px]">اونلاين</th>
            <th class="p-3 whitespace-nowrap min-w-[100px]">ودي</th>
          </tr>
        </thead>

        <!-- جسم الجدول - بيانات وهمية لحين تحديث الـ TS -->
        <tbody>
          @for (row of reportData(); track row.company) {
            <tr class="border-b border-gray-100 hover:bg-gray-50 transition-colors">

              <!-- 1. الموكل (اسم الشركة) -->
              <td class="p-3 font-medium border-l text-gray-800">{{ row.company }}</td>

              <!-- 2. عدد الملفات (Mock) -->
              <td class="p-3 text-center border-l text-indigo-600 font-bold">150</td>

              <!-- 3. قيمة المطالبة (Mock) -->
              <td class="p-3 text-center border-l font-bold text-blue-700">75,000 د.ك</td>

              <!-- 4. المدفوع (Mock) -->
              <td class="p-3 text-center border-l font-bold text-green-700">12,500</td>

              <!-- 5. المتبقي (Mock) -->
              <td class="p-3 text-center border-l font-bold text-orange-600">62,500</td>

              <!-- 6. غير قابل للتحصيل (Mock) -->
              <td class="p-3 text-center border-l">1,000</td>

              <!-- 7. غير قابل للتحصيل (موزع) (Mock) -->
              <td class="p-3 text-center border-l">500</td>

              <!-- 8. غير قابل للتحصيل (غير موزع) (Mock) -->
              <td class="p-3 text-center border-l">500</td>

              <!-- 9. قابل للتحصيل (Mock) -->
              <td class="p-3 text-center border-l font-bold text-green-600">60,000</td>

              <!-- 10. قابل للتحصيل (موزع) (Mock) -->
              <td class="p-3 text-center border-l">20,000</td>

              <!-- 11. قابل للتحصيل (متواصل) (Mock) -->
              <td class="p-3 text-center border-l">15,000</td>

              <!-- 12. قابل للتحصيل (غير متواصل) (Mock) -->
              <td class="p-3 text-center border-l">5,000</td>

              <!-- 13. قابل للتحصيل (لا يمكن التواصل) (Mock) -->
              <td class="p-3 text-center border-l">1,000</td>

              <!-- 14. قابل للتحصيل (متواصل مع اخر) (Mock) -->
              <td class="p-3 text-center border-l">3,000</td>

              <!-- 15. قابل للتحصيل (غير مصنف) (Mock) -->
              <td class="p-3 text-center border-l">1,000</td>

              <!-- 16. قابل للتحصيل (متابع) (Mock) -->
              <td class="p-3 text-center border-l">2,500</td>

              <!-- 17. قابل للتحصيل (غير متابع) (Mock) -->
              <td class="p-3 text-center border-l">500</td>

              <!-- 18. قابل للتحصيل (لم يتم الإتصال) (Mock) -->
              <td class="p-3 text-center border-l">1,500</td>

              <!-- 19. قابل للتحصيل (غير موزع) (Mock) -->
              <td class="p-3 text-center border-l">500</td>

              <!-- 20. تنفيذ (Mock) -->
              <td class="p-3 text-center border-l font-bold text-red-700">10</td>

              <!-- 21. متابع تنفيذ (Mock) -->
              <td class="p-3 text-center border-l">5</td>

              <!-- 22. غير متابع تنفيذ (Mock) -->
              <td class="p-3 text-center border-l">5</td>

              <!-- 23. الرسوم (Mock) -->
              <td class="p-3 text-center border-l">2,000</td>

              <!-- 24. اونلاين (Mock) -->
              <td class="p-3 text-center border-l">1,000</td>

              <!-- 25. ودي (Mock) -->
              <td class="p-3 text-center">1,000</td>

              <!-- تم إزالة خلايا نسبة النجاح والمبيعات القديمة -->
            </tr>
          }
        </tbody>
      </table>
    </div>
  } @else {
    <div class="mt-6 p-10 bg-white text-center text-gray-500 rounded-xl shadow">
      يرجى تحديد الفلاتر والضغط على "عرض التقرير" للحصول على نتائج الأداء.
    </div>
  }

</div>
