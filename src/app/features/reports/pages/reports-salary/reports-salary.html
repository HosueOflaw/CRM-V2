<div class="min-h-screen p-5 font-sans" dir="rtl"
     style="background-color: var(--surface-ground);">

  <!-- โ ุงูุดุฑูุท ุงูุนููู -->
  <div class="flex flex-wrap gap-3 mb-4">
    <app-go-back></app-go-back>
    <button (click)="reviewEntry(null)"
      class="bg-blue-600 hover:bg-blue-700 text-white font-medium px-5 py-2.5 rounded transition-colors">
      ูุฑุงุฌุนุฉ ุงูุญุณุงุจุงุช
    </button>

    <button (click)="showCheckVoucher(null)"
      class="bg-blue-600 hover:bg-blue-700 text-white font-medium px-5 py-2.5 rounded transition-colors">
      ุชู ุงููุฑุงุฌุนุฉ
    </button>

    <button (click)="showBondStatement(null)"
      class="bg-blue-600 hover:bg-blue-700 text-white font-medium px-5 py-2.5 rounded transition-colors">
      ุณูุฏุงุช ุตุฑู
    </button>

    <button (click)="showReceipt(null)"
      class="bg-blue-600 hover:bg-blue-700 text-white font-medium px-5 py-2.5 rounded transition-colors">
      ุนุฑุถ ุงูุณูุฏ
    </button>

    <!-- โ ุฒุฑ ุฑูุน ููู Excel -->
    <div class="relative inline-block">
      <input type="file" id="excelInput" accept=".xlsx, .xls" (change)="onFileSelected($event)" class="hidden" />
      <button (click)="triggerFileInput()"
        class="bg-green-700 hover:bg-green-800 text-white px-4 py-2 rounded transition-colors flex items-center justify-center">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
            d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
        </svg>
      </button>
    </div>

    <div *ngIf="uploadedFileName" class="mt-2 text-sm"
         style="color: var(--text-color-secondary);">
      ๐ {{ uploadedFileName }}
    </div>
  </div>

  <!-- โ ุงูุดุฑูุท ุงูุซุงูู -->
  <div class="flex flex-wrap gap-3 mb-4">
    <button (click)="showCurrentManagement()"
      class="bg-blue-600 hover:bg-blue-700 text-white font-medium px-5 py-2.5 rounded transition-colors">
      ุงูุฅุฏุงุฑุฉ ุงูุญุงููุฉ
    </button>

    <button (click)="reviewEntry(null)"
      class="bg-blue-600 hover:bg-blue-700 text-white font-medium px-5 py-2.5 rounded transition-colors">
      ุชู ุงููุฑุงุฌุนุฉ
    </button>

    <button (click)="showCheckVoucher(null)"
      class="bg-blue-600 hover:bg-blue-700 text-white font-medium px-5 py-2.5 rounded transition-colors">
      ุณูุฏุงุช ูุจุถ ุงูููุชุจ
    </button>
  </div>

  <!-- โ ุงูููุฑู -->
  <div class="p-5 rounded-lg shadow-md mb-5"
       style="background-color: var(--surface-card);">
    <div class="grid grid-cols-1 md:grid-cols-2 gap-5 mb-4">
      <div class="flex flex-col">
        <label class="font-semibold mb-1.5 text-sm text-right" style="color: var(--text-color);">ุงูููุฏ</label>
        <input type="text" [(ngModel)]="code"
          class="px-3 py-2 border rounded text-sm text-right focus:outline-none"
          style="border-color: var(--surface-border); background-color: var(--surface-ground); color: var(--text-color);" />
      </div>

      <div class="flex flex-col">
        <label class="font-semibold mb-1.5 text-sm text-right" style="color: var(--text-color);">ุงูุงุณู</label>
        <input type="text" [(ngModel)]="name"
          class="px-3 py-2 border rounded text-sm text-right focus:outline-none"
          style="border-color: var(--surface-border); background-color: var(--surface-ground); color: var(--text-color);" />
      </div>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-2 gap-5 mb-4">
      <div class="flex flex-col">
        <label class="font-semibold mb-1.5 text-sm text-right" style="color: var(--text-color);">ุงููุจูุบ</label>
        <input type="text" [(ngModel)]="amount"
          class="px-3 py-2 border rounded text-sm text-right focus:outline-none"
          style="border-color: var(--surface-border); background-color: var(--surface-ground); color: var(--text-color);" />
      </div>

      <div class="flex flex-col">
        <label class="font-semibold mb-1.5 text-sm text-right" style="color: var(--text-color);">ุงูุจูู</label>
        <input type="text" [(ngModel)]="bank"
          class="px-3 py-2 border rounded text-sm text-right focus:outline-none"
          style="border-color: var(--surface-border); background-color: var(--surface-ground); color: var(--text-color);" />
      </div>

      <div class="flex flex-col">
        <label class="font-semibold mb-1.5 text-sm text-right" style="color: var(--text-color);">ุงูุชุงุฑูุฎ</label>
        <input type="date" [(ngModel)]="date"
          class="px-3 py-2 border rounded text-sm text-right focus:outline-none"
          style="border-color: var(--surface-border); background-color: var(--surface-ground); color: var(--text-color);" />
      </div>
    </div>

    <div class="flex flex-col">
      <label class="font-semibold mb-1.5 text-sm text-right" style="color: var(--text-color);">ุฑูู ุงูุณูุฏ</label>
      <input type="number" [(ngModel)]="code"
        class="px-3 py-2 border rounded text-sm text-right focus:outline-none"
        style="border-color: var(--surface-border); background-color: var(--surface-ground); color: var(--text-color);" />
    </div>
  </div>

  <!-- โ ุงูุจุญุซ -->
  <div class="flex gap-3 mb-5 items-center">
    <input type="search" placeholder="ุงุจุญุซ ููุง..."
      class="flex-1 px-4 py-2.5 border rounded text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"
      style="border-color: var(--surface-border); background-color: var(--surface-card); color: var(--text-color);" />
    <button class="px-5 py-2.5 border rounded text-lg transition-colors"
            style="background-color: var(--surface-card); border-color: var(--surface-border); color: var(--text-color);">
      ๐
    </button>
  </div>

  <!-- โ ุงูุฌุฏูู -->
  <div class="rounded-lg shadow-md overflow-hidden"
       style="background-color: var(--surface-card);">
    <table class="w-full border-collapse"
           style="border-color: var(--surface-border);">
      <thead style="background-color: var(--surface-section);">
        <tr>
          <th class="px-3 py-3 text-right font-semibold border-b-2 text-sm"
              style="border-color: var(--surface-border); color: var(--text-color);">ุงูููุฏ</th>
          <th class="px-3 py-3 text-right font-semibold border-b-2 text-sm"
              style="border-color: var(--surface-border); color: var(--text-color);">ุงูุงุณู</th>
          <th class="px-3 py-3 text-right font-semibold border-b-2 text-sm"
              style="border-color: var(--surface-border); color: var(--text-color);">ุงูุชุงุฑูุฎ</th>
          <th class="px-3 py-3 text-right font-semibold border-b-2 text-sm"
              style="border-color: var(--surface-border); color: var(--text-color);">ุงูุจูู</th>
          <th class="px-3 py-3 text-right font-semibold border-b-2 text-sm"
              style="border-color: var(--surface-border); color: var(--text-color);">ุงููุจูุบ</th>
          <th class="px-3 py-3 text-right font-semibold border-b-2 text-sm"
              style="border-color: var(--surface-border); color: var(--text-color);">ุฑูู ุงูุณูุฏ</th>
          <th class="px-3 py-3 text-right font-semibold border-b-2 text-sm"
              style="border-color: var(--surface-border); color: var(--text-color);">ุฅุฌุฑุงุกุงุช</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let entry of entries; let i = index"
            [style.background-color]="i % 2 === 0 ? 'var(--surface-card)' : 'var(--surface-ground)'"
            style="color: var(--text-color); transition: background-color 0.2s;">
          <td class="px-3 py-3 text-right border-b text-sm"
              style="border-color: var(--surface-border);">{{ entry.code }}</td>
          <td class="px-3 py-3 text-right border-b text-sm"
              style="border-color: var(--surface-border);">{{ entry.name }}</td>
          <td class="px-3 py-3 text-right border-b text-sm"
              style="border-color: var(--surface-border);">{{ entry.date }}</td>
          <td class="px-3 py-3 text-right border-b text-sm"
              style="border-color: var(--surface-border);">{{ entry.bank }}</td>
          <td class="px-3 py-3 text-right border-b text-sm"
              style="border-color: var(--surface-border);">{{ entry.amount }}</td>
          <td class="px-3 py-3 text-right border-b text-sm"
              style="border-color: var(--surface-border);">{{ entry.id }}</td>
          <td class="px-3 py-3 text-right border-b"
              style="border-color: var(--surface-border);">
            <button (click)="deleteEntry(entry)"
              class="bg-red-600 hover:bg-red-700 text-white px-3 py-1.5 rounded text-xs font-medium transition-colors">
              ุญุฐู
            </button>
          </td>
        </tr>
        <tr *ngIf="entries.length === 0">
          <td colspan="7" class="text-center py-10 italic"
              style="color: var(--text-color-secondary);">
            ูุง ุชูุฌุฏ ุจูุงูุงุช
          </td>
        </tr>
      </tbody>
    </table>
  </div>

</div>

