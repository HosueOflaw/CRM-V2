<div class="p-6 bg-gray-100 min-h-screen" style="direction: rtl;">

  <!-- HEADER SEARCH -->
  <div class="bg-white p-4 rounded-xl shadow mb-6">
    <div class="grid grid-cols-6 gap-4 items-end">

      <!-- Input Options -->
      <div>
        <label class="block mb-1">القطاع</label>
        <select class="select select-bordered w-full">
          <option disabled selected>اختر القطاع</option>
          <option>قطاع 1</option>
          <option>قطاع 2</option>
        </select>
      </div>

      <div>
        <label class="block mb-1">الشركة</label>
        <select class="select select-bordered w-full">
          <option disabled selected>اختر الشركة</option>
          <option>شركة 1</option>
          <option>شركة 2</option>
        </select>
      </div>

      <div>
        <label class="block mb-1">Group</label>
        <select class="select select-bordered w-full">
          <option disabled selected>اختر المجموعة</option>
          <option>Group 1</option>
          <option>Group 2</option>
        </select>
      </div>

      <!-- التاريخ -->
      <div>
        <label class="block mb-1">التاريخ من</label>
        <input type="date" class="input input-bordered w-full">
      </div>

      <div>
        <label class="block mb-1">التاريخ إلى</label>
        <input type="date" class="input input-bordered w-full">
      </div>

      <!-- Buttons -->
      
      <div class="flex space-x-2">
      <button class="btn btn-primary" (click)="search('saddad')">السداد</button>
      <button class="btn btn-secondary" (click)="search('files')">الملفات</button>
      <button 
class="btn btn-accent mb-4"
(click)="exportToExcel()"
[disabled]="results.length === 0"
>
تحميل Excel
</button>
      </div>

    </div>
  </div>

  <!-- RESULTS TABLE -->
  <div class="overflow-x-auto bg-white rounded-xl shadow p-4">
    <table class="table table-zebra w-full">
      <thead>
        <tr>
          <th>الكود</th>
          <th>الاسم</th>
          <th>سبب المديونية</th>
          <th>رقم العقد</th>
          <th>رقم الباتش</th>
          <th>الموظف</th>
          <th>رقم الموظف</th>
          <th>قيمة المطالبة</th>
          <th>اجمالي المدفوع</th>
          <th>المتبقي</th>
          <th>تاريخ الورود</th>
          <th>الموكل</th>
          <th>كود الموكل</th>
          <th>تاريخ الاستلام</th>
          <th>تاريخ السحب</th>
          <th>الرقم الالي</th>
          <th>ملاحظات</th>
          <th>الجنسية</th>
          <th>المدني</th>
          <th>ملاحظات 2</th>
          <th>ملاحظات 3</th>
          <th>ملاحظات 4</th>
          <th>المحكمة</th>
          <th>ملاحظات الملفات</th>
          <th>group</th>
          <th>الخصم</th>
          <th>نسبة الخصم</th>
          <th>القطاع</th>
          <th>نسبة العمولة</th>
          <th>عمولة مستقطعة</th>
          <th>عمولة التسكير</th>
          <th>المحاسبة علي العمولة المستقطعة</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let row of results">
          <td>{{row.code}}</td>
          <td>{{row.name}}</td>
          <td>{{row.reason}}</td>
          <td>{{row.contractNumber}}</td>
          <td>{{row.batchNumber}}</td>
          <td>{{row.employee}}</td>
          <td>{{row.employeeNumber}}</td>
          <td>{{row.claimValue}}</td>
          <td>{{row.totalPaid}}</td>
          <td>{{row.remaining}}</td>
          <td>{{row.receiptDate}}</td>
          <td>{{row.client}}</td>
          <td>{{row.clientCode}}</td>
          <td>{{row.receiveDate}}</td>
          <td>{{row.withdrawDate}}</td>
          <td>{{row.autoNumber}}</td>
          <td>{{row.notes}}</td>
          <td>{{row.nationality}}</td>
          <td>{{row.civilNumber}}</td>
          <td>{{row.notes2}}</td>
          <td>{{row.notes3}}</td>
          <td>{{row.notes4}}</td>
          <td>{{row.court}}</td>
          <td>{{row.fileNotes}}</td>
          <td>{{row.group}}</td>
          <td>{{row.discount}}</td>
          <td>{{row.discountPercent}}</td>
          <td>{{row.sector}}</td>
          <td>{{row.commissionPercent}}</td>
          <td>{{row.deductedCommission}}</td>
          <td>{{row.closingCommission}}</td>
          <td>{{row.accountingDeduction}}</td>
        </tr>
      </tbody>
    </table>
  </div>

</div>
