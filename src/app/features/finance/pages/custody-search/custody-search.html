<div dir="rtl" class="flex flex-col h-screen bg-gray-50 p-4 font-sans text-sm">

    <!-- Header / Title -->
    <h1 class="text-lg font-bold text-gray-800 mb-4 border-b pb-2">
      كل العهد الموجودة على المستشار
    </h1>

    <!-- شريط البحث (Toolbar) -->
    <div class="bg-white p-3 rounded-lg shadow-md mb-4 flex justify-between items-center border border-gray-300">
        
        <!-- حقل الموكل وزر الـ Lookup -->
        <div class="flex items-center gap-3">
            <label class="font-bold text-gray-700">الموكل</label>
            
            <input type="text" 
                   class="input input-sm input-bordered rounded-none w-64 bg-yellow-50 border-yellow-400" 
                   [(ngModel)]="selectedClientName" 
                   placeholder="اختر موكل"
                   readonly />
            
            <!-- زر الـ Lookup Modal -->
            <button class="btn btn-sm bg-gray-200 hover:bg-gray-300 text-gray-700 border-gray-400 rounded-none"
                    (click)="openClientLookup()">
                ...
            </button>
            
            <!-- زر البحث -->
            <button class="btn btn-sm btn-primary rounded-none"
                    (click)="searchCustodies()">
                بحث
            </button>
        </div>

        <!-- معلومات المستشار (يمين) -->
        <div class="flex items-center gap-2">
            <label class="font-bold text-gray-700">المستشار:</label>
            <span class="text-blue-700 font-mono">{{ selectedConsultant }}</span>
        </div>
    </div>

    <!-- منطقة الجدول (Grid) -->
    <div class="flex-grow overflow-auto border border-gray-300 rounded-lg shadow-lg bg-white">
        
      

        <!-- الجدول نفسه -->
        <table class="table table-sm table-pin-rows w-full border-collapse text-right whitespace-nowrap">
            <thead>
                <tr class="bg-gray-100 text-gray-700 border-b border-gray-300">
                    <th class="w-12">الرقم</th>
                    <th>تاريخ العهدة</th>
                    <th>نوع العهدة</th>
                    <th>المبلغ</th>
                    <th>الموكل</th>
                    <th>المستخدم</th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let row of custodyRows">
                    <td class="font-mono">{{ row.id }}</td>
                    <td>{{ row.date }}</td>
                    <td>{{ row.type }}</td>
                    <td class="font-bold text-green-700">{{ row.amount | number }}</td>
                    <td>{{ row.client }}</td>
                    <td>{{ row.user }}</td>
                </tr>
                <tr *ngIf="custodyRows.length === 0">
                    <td colspan="6" class="text-center p-4 text-gray-500">لا توجد عهد لعرضها.</td>
                </tr>
            </tbody>
        </table>
    </div>
    
    <!-- استدعاء Lookup Modal (يتم وضعه في نهاية الـ Template) -->
    <app-lookup-modal
      #lookupModal
      (itemSelected)="onClientSelected($event)">
    </app-lookup-modal>

</div>